<html t:type="EpgLayout" title="VDR Jonglisto Index" xmlns:t="http://tapestry.apache.org/schema/tapestry_5_4.xsd" xmlns:p="tapestry:parameter">
    <t:zone t:id="epgListZone" id="epgListZone">

        <table class="table table-sm table-striped table-bordered">
            <t:loop source="epgData" value="channelEpg">
                <tr>
                    <th colspan="7">
                        <t:pagelink page="programChannel" parameters="{'channelId':channelId}">
                            <t:ChannelImage channelName="${channelName}" />
                        </t:pagelink>
                    </th>
                </tr>

                <tr>
                    <th class="timeCell">Time</th>
                    <th class="titleCell">Title</th>
                    <th class="seasonCell">Season</th>
                    <th class="partCell">Part</th>
                    <th class="genreCell">Genre</th>
                    <th class="categoryCell">Kategorie</th>
                    <th class="actionCell">Action</th>
                </tr>

                <t:loop source="channelEpg" value="epg">
                    <tr>
                        <td>
                            <div>
                                <t:pagelink page="programTime" parameters="{'searchTime':startTime}">
                                    ${map:epg['v_starttime']}
                                </t:pagelink>
                                -
                                <t:pagelink page="programTime" parameters="{'searchTime':endTime}">
                                    ${map:epg['v_endtime']}
                                </t:pagelink>
                            </div>

                            <t:if test="running">
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" aria-valuenow="${map:epg['proz']}" aria-valuemin="0" aria-valuemax="100"
                                        style="width:${map:epg['proz']}%">
                                    </div>
                                </div>
                            </t:if>
                        </td>

                        <td>
                            <t:eventlink t:event="showEpg" t:context="[useId,channelName]" zone="^">
                                <strong>${map:epg['title']}</strong>
                            </t:eventlink>
                            <br />
                            ${map:epg['shorttext']}
                        </td>

                        <td>
                            ${map:epg['season']}
                        </td>

                        <td>
                            ${map:epg['part']}
                        </td>

                        <td>
                            <t:eventlink t:event="selectGenre" t:context="${map:epg['genre']}" zone="^">
                                ${map:epg['genre']}
                            </t:eventlink>
                        </td>

                        <td>
                            <t:eventlink t:event="selectCategory" t:context="${map:epg['category']}" zone="^">
                                ${map:epg['category']}
                            </t:eventlink>
                        </td>

                        <td>
                            <t:pagelink page="timer" parameters="{'newTimerUseId':useId, 'channelName':channelName}">
                                <img src="${asset:record.svg}" alt="Record Timer" data-toggle="tooltip" title="Timer anlegen" class="iconwhlarge tooltipTop" />
                            </t:pagelink>

                            <t:eventlink t:event="switchChannel" context="channelId">
                                <img src="${asset:umschalten.svg}" alt="Channel Switch" data-toggle="tooltip" title="TV umschalten" class="iconwhlarge tooltipTop" />
                            </t:eventlink>
                        </td>
                    </tr>
                </t:loop>
            </t:loop>
        </table>
    </t:zone>
</html>
